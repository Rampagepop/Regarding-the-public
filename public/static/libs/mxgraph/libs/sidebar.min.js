function Sidebar(e,t,l){this.editorUi=e,this.container=t,this.palettes=new Object,this.taglist=new Object,this.showTooltips=!0,this.graph=e.createTemporaryGraph(this.editorUi.editor.graph.getStylesheet()),this.graph.cellRenderer.minSvgStrokeWidth=this.minThumbStrokeWidth,this.graph.cellRenderer.antiAlias=this.thumbAntiAlias,this.graph.container.style.visibility="hidden",this.graph.foldingEnabled=!1,document.body.appendChild(this.graph.container),l&&this.init(l.items)}Sidebar.prototype.init=function(e){this.addItems(e)},Sidebar.prototype.addItems=function(e){var t=STENCIL_PATH;if(e&&e.length>0){var l=[],i=[],n=[];e.forEach(function(e){l.push(e.img),i.push(e.title||""),n.push(e.data)}),this.addImagePalette("","",t,".png",l,i,null,n)}},Sidebar.prototype.addGeneralPalette=function(e){var t=[this.createEdgeTemplateEntry("endArrow=classic;html=1;",50,50,"","Directional Connector",null,"line lines connector connectors connection connections arrow arrows directional directed")];this.addPaletteFunctions("general",mxResources.get("general"),null==e||e,t)},Sidebar.prototype.collapsedImage=mxClient.IS_SVG?"data:image/gif;base64,R0lGODlhDQANAIABAJmZmf///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNUQyRTJFNjZGNUYxMUU1QjZEOThCNDYxMDQ2MzNCQiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozNUQyRTJFNzZGNUYxMUU1QjZEOThCNDYxMDQ2MzNCQiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjFERjc3MEUxNkY1RjExRTVCNkQ5OEI0NjEwNDYzM0JCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjFERjc3MEUyNkY1RjExRTVCNkQ5OEI0NjEwNDYzM0JCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAQAAAQAsAAAAAA0ADQAAAhSMj6lrwAjcC1GyahV+dcZJgeIIFgA7":IMAGE_PATH+"/collapsed.gif",Sidebar.prototype.expandedImage=mxClient.IS_SVG?"data:image/gif;base64,R0lGODlhDQANAIABAJmZmf///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxREY3NzBERjZGNUYxMUU1QjZEOThCNDYxMDQ2MzNCQiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxREY3NzBFMDZGNUYxMUU1QjZEOThCNDYxMDQ2MzNCQiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjFERjc3MERENkY1RjExRTVCNkQ5OEI0NjEwNDYzM0JCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjFERjc3MERFNkY1RjExRTVCNkQ5OEI0NjEwNDYzM0JCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAQAAAQAsAAAAAA0ADQAAAhGMj6nL3QAjVHIu6azbvPtWAAA7":IMAGE_PATH+"/expanded.gif",Sidebar.prototype.searchImage=mxClient.IS_SVG?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAEaSURBVHjabNGxS5VxFIfxz71XaWuQUJCG/gCHhgTD9VpEETg4aMOlQRp0EoezObgcd220KQiXmpretTAHQRBdojlQEJyukPdt+b1ywfvAGc7wnHP4nlZd1yKijQW8xzNc4Su+ZOYfQ3T6/f4YNvEJYzjELXp4VVXVz263+7cR2niBxAFeZ2YPi3iHR/gYERPDwhpOsd6sz8x/mfkNG3iOlWFhFj8y89J9KvzGXER0GuEaD42mgwHqUtoljbcRsTBCeINpfM/MgZLKPpaxFxGbOCqDXmILN7hoJrTKH+axhxmcYRxP0MIDnOBDZv5q1XUNIuJxifJp+UNV7t7BFM6xeic0RMQ4Bpl5W/ol7GISx/eEUUTECrbx+f8A8xhiZht9zsgAAAAASUVORK5CYII=":IMAGE_PATH+"/search.png",Sidebar.prototype.dragPreviewBorder="1px dashed black",Sidebar.prototype.enableTooltips=!0,Sidebar.prototype.tooltipBorder=16,Sidebar.prototype.tooltipDelay=300,Sidebar.prototype.dropTargetDelay=200,Sidebar.prototype.gearImage=STENCIL_PATH+"/clipart/Gear_128x128.png",Sidebar.prototype.thumbWidth=42,Sidebar.prototype.thumbHeight=42,Sidebar.prototype.minThumbStrokeWidth=1,Sidebar.prototype.thumbAntiAlias=!1,Sidebar.prototype.thumbPadding=document.documentMode>=5?2:3,Sidebar.prototype.thumbBorder=2,Sidebar.prototype.thumbPadding=document.documentMode>=5?2:11,Sidebar.prototype.thumbBorder=1,Sidebar.prototype.thumbWidth=30,Sidebar.prototype.thumbHeight=23,Sidebar.prototype.minThumbStrokeWidth=1.3,Sidebar.prototype.thumbAntiAlias=!0,Sidebar.prototype.sidebarTitleSize=9,Sidebar.prototype.sidebarTitles=!1,Sidebar.prototype.tooltipTitles=!0,Sidebar.prototype.maxTooltipWidth=400,Sidebar.prototype.maxTooltipHeight=400,Sidebar.prototype.addStencilsToIndex=!0,Sidebar.prototype.defaultImageWidth=42,Sidebar.prototype.defaultImageHeight=42,Sidebar.prototype.sidebarImageWidth=22,Sidebar.prototype.sidebarImageHeight=22,Sidebar.prototype.getTooltipOffset=function(){return new mxPoint(0,0)},Sidebar.prototype.addDataEntry=function(e,t,l,i,n){return this.addEntry(e,mxUtils.bind(this,function(){return this.createVertexTemplateFromData(n,t,l,i)}))},Sidebar.prototype.addEntries=function(e){for(var t=0;t<e.length;t++)mxUtils.bind(this,function(e){var t=e.data;null!=t&&null!=e.title?this.addEntry(e.title,mxUtils.bind(this,function(){t=this.editorUi.convertDataUri(t);var l="shape=image;verticalLabelPosition=bottom;verticalAlign=top;imageAspect=0;";return"fixed"==e.aspect&&(l+="aspect=fixed;"),this.createVertexTemplate(l+"image="+t,e.w,e.h,"",e.title||"",!1,!1,!0)})):null!=e.xml&&null!=e.title&&this.addEntry(e.title,mxUtils.bind(this,function(){var t=this.editorUi.stringToCells(Graph.decompress(e.xml));return this.createVertexTemplateFromCells(t,e.w,e.h,e.title||"",!0,!1,!0)}))})(e[t])},Sidebar.prototype.addEntry=function(e,t){if(null!=this.taglist&&null!=e&&e.length>0)for(var l=e.toLowerCase().replace(/[\/\,\(\)]/g," ").split(" "),i=mxUtils.bind(this,function(e){if(null!=e&&e.length>1){var l=this.taglist[e];"object"!=typeof l&&(l={entries:[],dict:new mxDictionary},this.taglist[e]=l),null==l.dict.get(t)&&(l.dict.put(t,t),l.entries.push(t))}}),n=0;n<l.length;n++){i(l[n]);var r=l[n].replace(/\.*\d*$/,"");r!=l[n]&&i(r)}return t},Sidebar.prototype.searchEntries=function(e,t,l,i,n){if(null!=this.taglist&&null!=e){for(var r=e.toLowerCase().split(" "),o=new mxDictionary,a=(l+1)*t,s=[],d=0,h=0;h<r.length;h++)if(r[h].length>0){var p=this.taglist[r[h]],u=new mxDictionary;if(null!=p){var m=p.entries;s=[];for(var c=0;c<m.length;c++){p=m[c];if(0==d==(null==o.get(p))&&(u.put(p,p),s.push(p),h==r.length-1&&s.length==a))return void i(s.slice(l*t,a),a,!0,r)}}else s=[];o=u,d++}var g=s.length;i(s.slice(l*t,(l+1)*t),g,!1,r)}else i([],null,null,r)},Sidebar.prototype.filterTags=function(e){if(null!=e){for(var t=e.split(" "),l=[],i={},n=0;n<t.length;n++)null==i[t[n]]&&(i[t[n]]="1",l.push(t[n]));return l.join(" ")}return null},Sidebar.prototype.cloneCell=function(e,t){var l=e.clone();return null!=t&&(l.value=t),l},Sidebar.prototype.addSearchPalette=function(e){var t=document.createElement("div");t.style.visibility="hidden",this.container.appendChild(t);var l=document.createElement("div");l.className="geSidebar",l.style.boxSizing="border-box",l.style.overflow="hidden",l.style.width="100%",l.style.padding="8px",l.style.paddingTop="14px",l.style.paddingBottom="0px",e||(l.style.display="none");var i=document.createElement("div");i.style.whiteSpace="nowrap",i.style.textOverflow="clip",i.style.paddingBottom="8px",i.style.cursor="default";var n=document.createElement("input");n.setAttribute("placeholder",mxResources.get("searchShapes")),n.setAttribute("type","text"),n.style.fontSize="12px",n.style.overflow="hidden",n.style.boxSizing="border-box",n.style.border="solid 1px #d5d5d5",n.style.borderRadius="4px",n.style.width="100%",n.style.outline="none",n.style.padding="6px",n.style.paddingRight="20px",i.appendChild(n);var r,o=document.createElement("img");o.setAttribute("src",Sidebar.prototype.searchImage),o.setAttribute("title",mxResources.get("search")),o.style.position="relative",o.style.left="-18px",mxClient.IS_QUIRKS?(n.style.height="28px",o.style.top="-4px"):o.style.top="1px",o.style.background="url('"+this.editorUi.editor.transparentImage+"')",i.appendChild(o),l.appendChild(i);var a=document.createElement("center"),s=mxUtils.button(mxResources.get("moreResults"),function(){r()});s.style.display="none",s.style.lineHeight="normal",s.style.marginTop="4px",s.style.marginBottom="8px",a.style.paddingTop="4px",a.style.paddingBottom="4px",a.appendChild(s),l.appendChild(a);var d="",h=!1,p=!1,u=0,m=new Object,c=12,g=mxUtils.bind(this,function(){h=!1,this.currentSearch=null;for(var e=l.firstChild;null!=e;){var t=e.nextSibling;e!=i&&e!=a&&e.parentNode.removeChild(e),e=t}});mxEvent.addListener(o,"click",function(){o.getAttribute("src")==Dialog.prototype.closeImage&&(o.setAttribute("src",Sidebar.prototype.searchImage),o.setAttribute("title",mxResources.get("search")),s.style.display="none",n.value="",d="",g()),n.focus()}),r=mxUtils.bind(this,function(){if(c=4*Math.max(1,Math.floor(this.container.clientWidth/(this.thumbWidth+10))),""!=n.value){if(null!=a.parentNode&&(d!=n.value&&(g(),d=n.value,m=new Object,p=!1,u=0),!h&&!p)){s.setAttribute("disabled","true"),s.style.display="",s.style.cursor="wait",s.innerHTML=mxResources.get("loading")+"...",h=!0;var e=new Object;this.currentSearch=e,this.searchEntries(d,c,u,mxUtils.bind(this,function(t,i,n,r){if(this.currentSearch==e){t=null!=t?t:[],h=!1,u++,this.insertSearchHint(l,d,c,u,t,i,n,r),0==t.length&&1==u&&(d=""),null!=a.parentNode&&a.parentNode.removeChild(a);for(var o=0;o<t.length;o++)try{var g=t[o]();null==m[g.innerHTML]&&(m[g.innerHTML]="1",l.appendChild(g))}catch(e){}n?(s.removeAttribute("disabled"),s.innerHTML=mxResources.get("moreResults")):(s.innerHTML=mxResources.get("reset"),s.style.display="none",p=!0),s.style.cursor="",l.appendChild(a)}}),mxUtils.bind(this,function(){s.style.cursor=""}))}}else g(),n.value="",d="",m=new Object,s.style.display="none",p=!1,n.focus()}),mxEvent.addListener(n,"keydown",mxUtils.bind(this,function(e){13==e.keyCode&&(r(),mxEvent.consume(e))})),mxEvent.addListener(n,"keyup",mxUtils.bind(this,function(e){""==n.value?(o.setAttribute("src",Sidebar.prototype.searchImage),o.setAttribute("title",mxResources.get("search"))):(o.setAttribute("src",Dialog.prototype.closeImage),o.setAttribute("title",mxResources.get("reset"))),""==n.value?(p=!0,s.style.display="none"):n.value!=d?(s.style.display="none",p=!1):h||(s.style.display=p?"none":"")})),mxEvent.addListener(n,"mousedown",function(e){e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0}),mxEvent.addListener(n,"selectstart",function(e){e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0});var y=document.createElement("div");y.appendChild(l),this.container.appendChild(y),this.palettes.search=[t,y]},Sidebar.prototype.insertSearchHint=function(e,t,l,i,n,r,o,a){if(0==n.length&&1==i){var s=document.createElement("div");s.className="geTitle",s.style.cssText="background-color:transparent;border-color:transparent;color:gray;padding:6px 0px 0px 0px !important;margin:4px 8px 4px 8px;text-align:center;cursor:default !important",mxUtils.write(s,mxResources.get("noResultsFor",[t])),e.appendChild(s)}},Sidebar.prototype.createTitle=function(e){var t=document.createElement("a");return t.setAttribute("title",mxResources.get("sidebarTooltip")),t.className="geTitle",mxUtils.write(t,e),t},Sidebar.prototype.createThumb=function(e,t,l,i,n,r,o,a,s){this.graph.labelsVisible=null==r||r;var d=mxClient.NO_FO;mxClient.NO_FO=Editor.prototype.originalNoForeignObject,this.graph.view.scaleAndTranslate(1,0,0),this.graph.addCells(e);var h=this.graph.getGraphBounds(),p=Math.floor(100*Math.min((t-2*this.thumbBorder)/h.width,(l-2*this.thumbBorder)/h.height))/100;this.graph.view.scaleAndTranslate(p,Math.floor((t-h.width*p)/2/p-h.x),Math.floor((l-h.height*p)/2/p-h.y));var u=null;if(this.graph.dialect!=mxConstants.DIALECT_SVG||mxClient.NO_FO||null==this.graph.view.getCanvas().ownerSVGElement?((u=this.graph.container.cloneNode(!1)).innerHTML=this.graph.container.innerHTML,(mxClient.IS_QUIRKS||8==document.documentMode)&&(u.firstChild.style.overflow="visible")):u=this.graph.view.getCanvas().ownerSVGElement.cloneNode(!0),this.graph.getModel().clear(),mxClient.NO_FO=d,mxClient.IS_IE6&&(i.style.backgroundImage="url("+this.editorUi.editor.transparentImage+")"),u.style.position="relative",u.style.overflow="hidden",u.style.left=this.thumbBorder+"px",u.style.top=this.thumbBorder+"px",u.style.width=t+"px",u.style.height=l+"px",u.style.visibility="",u.style.minWidth="",u.style.minHeight="",i.appendChild(u),this.sidebarTitles&&null!=n&&0!=o){var m=mxClient.IS_QUIRKS?2*this.thumbPadding+2:0;i.style.height=this.thumbHeight+m+this.sidebarTitleSize+8+"px";var c=document.createElement("div");c.style.fontSize=this.sidebarTitleSize+"px",c.style.color="#303030",c.style.textAlign="center",c.style.whiteSpace="nowrap",mxClient.IS_IE&&(c.style.height=this.sidebarTitleSize+12+"px"),c.style.paddingTop="4px",mxUtils.write(c,n),i.appendChild(c)}return h},Sidebar.prototype.createItem=function(e,t,l,i,n,r,o){var a=document.createElement("a");a.className="geItem",a.style.overflow="hidden";var s=mxClient.IS_QUIRKS?8+2*this.thumbPadding:2*this.thumbBorder;a.style.width=this.thumbWidth+s+"px",a.style.height=this.thumbHeight+s+"px",a.style.padding=this.thumbPadding+"px",a.setAttribute("title",t),mxClient.IS_IE6&&(a.style.border="none"),mxEvent.addListener(a,"click",function(e){mxEvent.consume(e)}),this.createThumb(e,this.thumbWidth,this.thumbHeight,a,t,l,i,n,r);var d=new mxRectangle(0,0,n,r);if(e.length>1||e[0].vertex){var h=this.createDragSource(a,this.createDropHandler(e,!0,o,d),this.createDragPreview(n,r),e,d);this.addClickHandler(a,h,e),h.isGuidesEnabled=mxUtils.bind(this,function(){return this.editorUi.editor.graph.graphHandler.guidesEnabled})}else if(null!=e[0]&&e[0].edge){h=this.createDragSource(a,this.createDropHandler(e,!1,o,d),this.createDragPreview(n,r),e,d);this.addClickHandler(a,h,e)}var p=document.createElement("span");return mxUtils.write(p,t),a.appendChild(p),a},Sidebar.prototype.updateShapes=function(e,t){var l=this.editorUi.editor.graph,i=l.getCellStyle(e),n=[];l.model.beginUpdate();try{for(var r=l.getModel().getStyle(e),o=["shadow","dashed","dashPattern","fontFamily","fontSize","fontColor","align","startFill","startSize","endFill","endSize","strokeColor","strokeWidth","fillColor","gradientColor","html","part","noEdgeStyle","edgeStyle","elbow","childLayout","container","collapsible","connectable"],a=0;a<t.length;a++){var s=t[a];if(l.getModel().isVertex(s)==l.getModel().isVertex(e)||l.getModel().isEdge(s)==l.getModel().isEdge(e)){var d=l.view.getState(s),h=null!=d?d.style:l.getCellStyle(t[a]);if(l.getModel().setStyle(s,r),null!=d&&"1"==mxUtils.getValue(d.style,"composite","0"))for(var p=l.model.getChildCount(s);p>=0;p--)l.model.remove(l.model.getChildAt(s,p));if(null!=h){"umlLifeline"==h[mxConstants.STYLE_SHAPE]&&"umlLifeline"!=i[mxConstants.STYLE_SHAPE]&&(l.setCellStyles(mxConstants.STYLE_SHAPE,"umlLifeline",[s]),l.setCellStyles("participant",i[mxConstants.STYLE_SHAPE],[s]));for(p=0;p<o.length;p++){var u=h[o[p]];null!=u&&l.setCellStyles(o[p],u,[s])}}n.push(s)}}}finally{l.model.endUpdate()}return n},Sidebar.prototype.createDropHandler=function(e,t,l,i){return l=null==l||l,mxUtils.bind(this,function(n,r,o,a,s,d){for(var h=d?null:mxEvent.isTouchEvent(r)||mxEvent.isPenEvent(r)?document.elementFromPoint(mxEvent.getClientX(r),mxEvent.getClientY(r)):mxEvent.getSource(r);null!=h&&h!=this.container;)h=h.parentNode;if(null==h&&n.isEnabled()){if((e=n.getImportableCells(e)).length>0){n.stopEditing();var p=null!=o&&!mxEvent.isAltDown(r)&&n.isValidDropTarget(o,e,r),u=null;if(null==o||p||(o=null),!n.isCellLocked(o||n.getDefaultParent())){n.model.beginUpdate();try{if(a=Math.round(a),s=Math.round(s),t&&n.isSplitTarget(o,e,r)){var m=n.cloneCells(e);n.splitEdge(o,m,null,a-i.width/2,s-i.height/2),u=m}else e.length>0&&(u=n.importCells(e,a,s,o));if(null!=n.layoutManager){var c=n.layoutManager.getLayout(o);if(null!=c)for(var g=n.view.scale,y=n.view.translate,x=(a+y.x)*g,v=(s+y.y)*g,E=0;E<u.length;E++)c.moveCell(u[E],x,v)}!l||null!=r&&mxEvent.isShiftDown(r)||n.fireEvent(new mxEventObject("cellsInserted","cells",u))}catch(e){this.editorUi.handleError(e)}finally{n.model.endUpdate()}null!=u&&u.length>0&&(n.scrollCellToVisible(u[0]),n.setSelectionCells(u)),n.editAfterInsert&&null!=r&&mxEvent.isMouseEvent(r)&&null!=u&&1==u.length&&window.setTimeout(function(){n.startEditing(u[0])},0)}}mxEvent.consume(r)}})},Sidebar.prototype.createDragPreview=function(e,t){var l=document.createElement("div");return l.style.border=this.dragPreviewBorder,l.style.width=e+"px",l.style.height=t+"px",l},Sidebar.prototype.dropAndConnect=function(e,t,l,i,n){var r=this.getDropAndConnectGeometry(e,t[i],l,t),o=[];if(null!=r){var a=this.editorUi.editor.graph,s=null;a.model.beginUpdate();try{var d=a.getCellGeometry(e),h=a.getCellGeometry(t[i]),p=a.model.getParent(e),u=!0;if(null!=a.layoutManager){var m=a.layoutManager.getLayout(p);if(null!=m&&m.constructor==mxStackLayout)if(u=!1,null!=(o=a.view.getState(p))){var c=new mxPoint(o.x/a.view.scale-a.view.translate.x,o.y/a.view.scale-a.view.translate.y);r.x+=c.x,r.y+=c.y;var g=r.getTerminalPoint(!1);null!=g&&(g.x+=c.x,g.y+=c.y)}}var y=h.x,x=h.y;a.model.isEdge(t[i])&&(y=0,x=0);var v=a.model.isEdge(e)||null!=d&&!d.relative&&u;if(o=t=a.importCells(t,r.x-(v?y:0),r.y-(v?x:0),v?p:null),a.model.isEdge(e))a.model.setTerminal(e,t[i],l==mxConstants.DIRECTION_NORTH);else if(a.model.isEdge(t[i])){a.model.setTerminal(t[i],e,!0);var E=a.getCellGeometry(t[i]);if(E.points=null,null!=E.getTerminalPoint(!1))E.setTerminalPoint(r.getTerminalPoint(!1),!1);else if(v&&a.model.isVertex(p)){var b=a.view.getState(p);c=b.cell!=a.view.currentRoot?new mxPoint(b.x/a.view.scale-a.view.translate.x,b.y/a.view.scale-a.view.translate.y):new mxPoint(0,0);a.cellsMoved(t,c.x,c.y,null,null,!0)}}else h=a.getCellGeometry(t[i]),y=r.x-Math.round(h.x),x=r.y-Math.round(h.y),r.x=Math.round(h.x),r.y=Math.round(h.y),a.model.setGeometry(t[i],r),a.cellsMoved(t,y,x,null,null,!0),o=t.slice(),s=1==o.length?o[0]:null,t.push(a.insertEdge(null,null,"",e,t[i],a.createCurrentEdgeStyle()));null!=n&&mxEvent.isShiftDown(n)||a.fireEvent(new mxEventObject("cellsInserted","cells",t))}catch(e){this.editorUi.handleError(e)}finally{a.model.endUpdate()}a.editAfterInsert&&null!=n&&mxEvent.isMouseEvent(n)&&null!=s&&window.setTimeout(function(){a.startEditing(s)},0)}return o},Sidebar.prototype.getDropAndConnectGeometry=function(e,t,l,i){var n=this.editorUi.editor.graph,r=n.view,o=i.length>1,a=n.getCellGeometry(e),s=n.getCellGeometry(t);if(null!=a&&null!=s)if(s=s.clone(),n.model.isEdge(e)){var d=(u=n.view.getState(e)).absolutePoints,h=d[0],p=d[d.length-1];l==mxConstants.DIRECTION_NORTH?(s.x=h.x/r.scale-r.translate.x-s.width/2,s.y=h.y/r.scale-r.translate.y-s.height/2):(s.x=p.x/r.scale-r.translate.x-s.width/2,s.y=p.y/r.scale-r.translate.y-s.height/2)}else{if(a.relative){var u=n.view.getState(e);(a=a.clone()).x=(u.x-r.translate.x)/r.scale,a.y=(u.y-r.translate.y)/r.scale}var m=n.defaultEdgeLength;if(n.model.isEdge(t)&&null!=s.getTerminalPoint(!0)&&null!=s.getTerminalPoint(!1)){h=s.getTerminalPoint(!0);var c=(p=s.getTerminalPoint(!1)).x-h.x,g=p.y-h.y;m=Math.sqrt(c*c+g*g),s.x=a.getCenterX(),s.y=a.getCenterY(),s.width=1,s.height=1,l==mxConstants.DIRECTION_NORTH?(s.height=m,s.y=a.y-m,s.setTerminalPoint(new mxPoint(s.x,s.y),!1)):l==mxConstants.DIRECTION_EAST?(s.width=m,s.x=a.x+a.width,s.setTerminalPoint(new mxPoint(s.x+s.width,s.y),!1)):l==mxConstants.DIRECTION_SOUTH?(s.height=m,s.y=a.y+a.height,s.setTerminalPoint(new mxPoint(s.x,s.y+s.height),!1)):l==mxConstants.DIRECTION_WEST&&(s.width=m,s.x=a.x-m,s.setTerminalPoint(new mxPoint(s.x,s.y),!1))}else if(!o&&s.width>45&&s.height>45&&a.width>45&&a.height>45&&(s.width=s.width*(a.height/s.height),s.height=a.height),s.x=a.x+a.width/2-s.width/2,s.y=a.y+a.height/2-s.height/2,l==mxConstants.DIRECTION_NORTH?s.y=s.y-a.height/2-s.height/2-m:l==mxConstants.DIRECTION_EAST?s.x=s.x+a.width/2+s.width/2+m:l==mxConstants.DIRECTION_SOUTH?s.y=s.y+a.height/2+s.height/2+m:l==mxConstants.DIRECTION_WEST&&(s.x=s.x-a.width/2-s.width/2-m),n.model.isEdge(t)&&null!=s.getTerminalPoint(!0)&&null!=t.getTerminal(!1)){var y=n.getCellGeometry(t.getTerminal(!1));null!=y&&(l==mxConstants.DIRECTION_NORTH?(s.x-=y.getCenterX(),s.y-=y.getCenterY()+y.height/2):l==mxConstants.DIRECTION_EAST?(s.x-=y.getCenterX()-y.width/2,s.y-=y.getCenterY()):l==mxConstants.DIRECTION_SOUTH?(s.x-=y.getCenterX(),s.y-=y.getCenterY()-y.height/2):l==mxConstants.DIRECTION_WEST&&(s.x-=y.getCenterX()+y.width/2,s.y-=y.getCenterY()))}}return s},Sidebar.prototype.createDragSource=function(e,t,l,i,n){for(var r=this.editorUi,o=r.editor.graph,a=null,s=null,d=this,h=0;h<i.length&&(null==s&&this.editorUi.editor.graph.model.isVertex(i[h])?s=h:null==a&&this.editorUi.editor.graph.model.isEdge(i[h])&&null==this.editorUi.editor.graph.model.getTerminal(i[h],!0)&&(a=h),null==s||null==a);h++);var p=mxUtils.makeDraggable(e,this.editorUi.editor.graph,mxUtils.bind(this,function(e,l,n,r,o){if(null!=this.updateThread&&window.clearTimeout(this.updateThread),null!=i&&null!=y&&S==v){var d=e.isCellSelected(y.cell)?e.getSelectionCells():[y.cell],h=this.updateShapes(e.model.isEdge(y.cell)?i[0]:i[s],d);e.setSelectionCells(h)}else if(null!=i&&null!=S&&null!=c&&S!=v){var p=e.model.isEdge(c.cell)||null==a?s:a;e.setSelectionCells(this.dropAndConnect(c.cell,i,f,p,l))}else t.apply(this,arguments);null!=this.editorUi.hoverIcons&&this.editorUi.hoverIcons.update(e.view.getState(e.getSelectionCell()))}),l,0,0,o.autoscroll,!0,!0);o.addListener(mxEvent.ESCAPE,function(e,t){p.isActive()&&p.reset()});var u=p.mouseDown;function m(e,t){var l=null;return mxClient.IS_IE&&!mxClient.IS_SVG?(mxClient.IS_IE6&&"CSS1Compat"!=document.compatMode?((l=document.createElement(mxClient.VML_PREFIX+":image")).setAttribute("src",e.src),l.style.borderStyle="none"):((l=document.createElement("div")).style.backgroundImage="url("+e.src+")",l.style.backgroundPosition="center",l.style.backgroundRepeat="no-repeat"),l.style.width=e.width+4+"px",l.style.height=e.height+4+"px",l.style.display=mxClient.IS_QUIRKS?"inline":"inline-block"):((l=mxUtils.createImage(e.src)).style.width=e.width+"px",l.style.height=e.height+"px"),null!=t&&l.setAttribute("title",t),mxUtils.setOpacity(l,e==this.refreshTarget?30:20),l.style.position="absolute",l.style.cursor="crosshair",l}p.mouseDown=function(e){mxEvent.isPopupTrigger(e)||mxEvent.isMultiTouchEvent(e)||(o.stopEditing(),u.apply(this,arguments))};var c=null,g=null,y=null,x=!1,v=m(this.refreshTarget,mxResources.get("replace")),E=null,b=m(this.roundDrop),C=m(this.roundDrop),f=mxConstants.DIRECTION_NORTH,S=null;function w(e,t,l,i){return null!=i.parentNode&&(mxUtils.contains(l,e,t)?(mxUtils.setOpacity(i,100),S=i):mxUtils.setOpacity(i,i==v?30:20)),l}var T=p.createPreviewElement;p.createPreviewElement=function(e){var t=T.apply(this,arguments);return mxClient.IS_SVG&&(t.style.pointerEvents="none"),this.previewElementWidth=t.style.width,this.previewElementHeight=t.style.height,t};var A=p.dragEnter;p.dragEnter=function(e,t){null!=r.hoverIcons&&r.hoverIcons.setDisplay("none"),A.apply(this,arguments)};var I=p.dragExit;p.dragExit=function(e,t){null!=r.hoverIcons&&r.hoverIcons.setDisplay(""),I.apply(this,arguments)},p.dragOver=function(e,t){if(mxDragSource.prototype.dragOver.apply(this,arguments),null!=this.currentGuide&&null!=S&&this.currentGuide.hide(),null!=this.previewElement){var l=e.view;if(null!=y&&S==v)this.previewElement.style.display=e.model.isEdge(y.cell)?"none":"",this.previewElement.style.left=y.x+"px",this.previewElement.style.top=y.y+"px",this.previewElement.style.width=y.width+"px",this.previewElement.style.height=y.height+"px";else if(null!=c&&null!=S){var r=e.model.isEdge(c.cell)||null==a?s:a,o=d.getDropAndConnectGeometry(c.cell,i[r],f,i),h=e.model.isEdge(c.cell)?null:e.getCellGeometry(c.cell),u=e.getCellGeometry(i[r]),m=e.model.getParent(c.cell),g=l.translate.x*l.scale,x=l.translate.y*l.scale;if(null!=h&&!h.relative&&e.model.isVertex(m)&&m!=l.currentRoot){var E=l.getState(m);g=E.x,x=E.y}var b=u.x,C=u.y;e.model.isEdge(i[r])&&(b=0,C=0),this.previewElement.style.left=(o.x-b)*l.scale+g+"px",this.previewElement.style.top=(o.y-C)*l.scale+x+"px",1==i.length&&(this.previewElement.style.width=o.width*l.scale+"px",this.previewElement.style.height=o.height*l.scale+"px"),this.previewElement.style.display=""}else null!=p.currentHighlight.state&&e.model.isEdge(p.currentHighlight.state.cell)?(this.previewElement.style.left=Math.round(parseInt(this.previewElement.style.left)-n.width*l.scale/2)+"px",this.previewElement.style.top=Math.round(parseInt(this.previewElement.style.top)-n.height*l.scale/2)+"px"):(this.previewElement.style.width=this.previewElementWidth,this.previewElement.style.height=this.previewElementHeight,this.previewElement.style.display="")}};var N=(new Date).getTime(),R=0,D=null,U=this.editorUi.editor.graph.getCellStyle(i[0]);return p.getDropTarget=mxUtils.bind(this,function(e,t,l,n){var r=mxEvent.isAltDown(n)||null==i?null:e.getCellAt(t,l);if(null!=r&&!this.graph.isCellConnectable(r)){var o=this.graph.getModel().getParent(r);this.graph.getModel().isVertex(o)&&this.graph.isCellConnectable(o)&&(r=o)}e.isCellLocked(r)&&(r=null);var a=e.view.getState(r);S=null;var d=null;if(D!=a?(D=a,N=(new Date).getTime(),R=0,null!=this.updateThread&&window.clearTimeout(this.updateThread),null!=a&&(this.updateThread=window.setTimeout(function(){null==S&&(D=a,p.getDropTarget(e,t,l,n))},this.dropTargetDelay+10))):R=(new Date).getTime()-N,R<2500&&null!=a&&!mxEvent.isShiftDown(n)&&(mxUtils.getValue(a.style,mxConstants.STYLE_SHAPE)!=mxUtils.getValue(U,mxConstants.STYLE_SHAPE)&&(mxUtils.getValue(a.style,mxConstants.STYLE_STROKECOLOR,mxConstants.NONE)!=mxConstants.NONE||mxUtils.getValue(a.style,mxConstants.STYLE_FILLCOLOR,mxConstants.NONE)!=mxConstants.NONE||mxUtils.getValue(a.style,mxConstants.STYLE_GRADIENTCOLOR,mxConstants.NONE)!=mxConstants.NONE)||"image"==mxUtils.getValue(U,mxConstants.STYLE_SHAPE)||R>1500||e.model.isEdge(a.cell))&&R>this.dropTargetDelay&&(e.model.isVertex(a.cell)&&null!=s||e.model.isEdge(a.cell)&&e.model.isEdge(i[0]))){y=a;var h=e.model.isEdge(a.cell)?e.view.getPoint(a):new mxPoint(a.getCenterX(),a.getCenterY());h=new mxRectangle(h.x-this.refreshTarget.width/2,h.y-this.refreshTarget.height/2,this.refreshTarget.width,this.refreshTarget.height),v.style.left=Math.floor(h.x)+"px",v.style.top=Math.floor(h.y)+"px",null==E&&(e.container.appendChild(v),E=v.parentNode),w(t,l,h,v)}else if(null==y||!mxUtils.contains(y,t,l)||R>1500&&!mxEvent.isShiftDown(n))y=null,null!=E&&(v.parentNode.removeChild(v),E=null);else if(null!=y&&null!=E){h=e.model.isEdge(y.cell)?e.view.getPoint(y):new mxPoint(y.getCenterX(),y.getCenterY());h=new mxRectangle(h.x-this.refreshTarget.width/2,h.y-this.refreshTarget.height/2,this.refreshTarget.width,this.refreshTarget.height),w(t,l,h,v)}if(x&&null!=c&&!mxEvent.isAltDown(n)&&null==S){if(d=mxRectangle.fromRectangle(c),e.model.isEdge(c.cell)){var u=c.absolutePoints;if(null!=b.parentNode){var m=u[0];d.add(w(t,l,new mxRectangle(m.x-this.roundDrop.width/2,m.y-this.roundDrop.height/2,this.roundDrop.width,this.roundDrop.height),b))}if(null!=C.parentNode){var T=u[u.length-1];d.add(w(t,l,new mxRectangle(T.x-this.roundDrop.width/2,T.y-this.roundDrop.height/2,this.roundDrop.width,this.roundDrop.height),C))}}else{var A=mxRectangle.fromRectangle(c);null!=c.shape&&null!=c.shape.boundingBox&&(A=mxRectangle.fromRectangle(c.shape.boundingBox)),A.grow(this.graph.tolerance)}null!=d&&d.grow(10)}f=mxConstants.DIRECTION_NORTH,null!=y&&S==v&&(a=y);var I=(null==s||e.isCellConnectable(i[s]))&&(e.model.isEdge(r)&&null!=s||e.model.isVertex(r)&&e.isCellConnectable(r));if(null!=c&&R>=5e3||c!=a&&(null==d||!mxUtils.contains(d,t,l)||R>500&&null==S&&I))if(x=!1,null!=(c=R<5e3&&R>this.dropTargetDelay||e.model.isEdge(r)?a:null)&&I){for(var P=[b,C],O=0;O<P.length;O++)null!=P[O].parentNode&&P[O].parentNode.removeChild(P[O]);if(e.model.isEdge(r)){if(null!=(u=a.absolutePoints)){m=u[0],T=u[u.length-1];var M=e.tolerance;new mxRectangle(t-M,l-M,2*M,2*M);b.style.left=Math.floor(m.x-this.roundDrop.width/2)+"px",b.style.top=Math.floor(m.y-this.roundDrop.height/2)+"px",C.style.left=Math.floor(T.x-this.roundDrop.width/2)+"px",C.style.top=Math.floor(T.y-this.roundDrop.height/2)+"px",null==e.model.getTerminal(r,!0)&&e.container.appendChild(b),null==e.model.getTerminal(r,!1)&&e.container.appendChild(C)}}else{A=mxRectangle.fromRectangle(a);null!=a.shape&&null!=a.shape.boundingBox&&(A=mxRectangle.fromRectangle(a.shape.boundingBox)),A.grow(this.graph.tolerance)}null!=a&&null!=(g=e.selectionCellsHandler.getHandler(a.cell))&&null!=g.setHandlesVisible&&g.setHandlesVisible(!1),x=!0}else for(P=[b,C],O=0;O<P.length;O++)null!=P[O].parentNode&&P[O].parentNode.removeChild(P[O]);x||null==g||g.setHandlesVisible(!0);var L=mxEvent.isAltDown(n)&&!mxEvent.isShiftDown(n)||null!=y&&S==v?null:mxDragSource.prototype.getDropTarget.apply(this,arguments),H=e.getModel();if(null!=L&&(null!=S||!e.isSplitTarget(L,i,n))){for(;null!=L&&!e.isValidDropTarget(L,i,n)&&H.isVertex(H.getParent(L));)L=H.getParent(L);(e.view.currentRoot==L||!e.isValidRoot(L)&&0==e.getModel().getChildCount(L)||e.isCellLocked(L)||H.isEdge(L))&&(L=null)}return L}),p.stopDrag=function(){mxDragSource.prototype.stopDrag.apply(this,arguments);for(var e=[b,C,v],t=0;t<e.length;t++)null!=e[t].parentNode&&e[t].parentNode.removeChild(e[t]);null!=c&&null!=g&&g.reset(),g=null,c=null,y=null,E=null,S=null},p},Sidebar.prototype.itemClicked=function(e,t,l,i){var n=this.editorUi.editor.graph;if(n.container.focus(),mxEvent.isAltDown(l)&&1==n.getSelectionCount()&&n.model.isVertex(n.getSelectionCell())){for(var r=null,o=0;o<e.length&&null==r;o++)n.model.isVertex(e[o])&&(r=o);null!=r&&(n.setSelectionCells(this.dropAndConnect(n.getSelectionCell(),e,mxEvent.isMetaDown(l)||mxEvent.isControlDown(l)?mxEvent.isShiftDown(l)?mxConstants.DIRECTION_WEST:mxConstants.DIRECTION_NORTH:mxEvent.isShiftDown(l)?mxConstants.DIRECTION_EAST:mxConstants.DIRECTION_SOUTH,r,l)),n.scrollCellToVisible(n.getSelectionCell()))}else if(mxEvent.isShiftDown(l)&&!n.isSelectionEmpty())this.updateShapes(e[0],n.getSelectionCells()),n.scrollCellToVisible(n.getSelectionCell());else{var a=n.getFreeInsertPoint();if(mxEvent.isAltDown(l)){var s=n.getGraphBounds(),d=n.view.translate,h=n.view.scale;a.x=s.x/h-d.x+s.width/h+n.gridSize,a.y=s.y/h-d.y}t.drop(n,l,null,a.x,a.y,!0),null!=this.editorUi.hoverIcons&&(mxEvent.isTouchEvent(l)||mxEvent.isPenEvent(l))&&this.editorUi.hoverIcons.update(n.view.getState(n.getSelectionCell()))}},Sidebar.prototype.addClickHandler=function(e,t,l){var i=this.editorUi.editor.graph,n=t.mouseDown,r=t.mouseMove,o=t.mouseUp,a=i.tolerance,s=null,d=this;t.mouseDown=function(t){n.apply(this,arguments),s=new mxPoint(mxEvent.getClientX(t),mxEvent.getClientY(t)),null!=this.dragElement&&(this.dragElement.style.display="none",mxUtils.setOpacity(e,50))},t.mouseMove=function(t){null!=this.dragElement&&"none"==this.dragElement.style.display&&null!=s&&(Math.abs(s.x-mxEvent.getClientX(t))>a||Math.abs(s.y-mxEvent.getClientY(t))>a)&&(this.dragElement.style.display="",mxUtils.setOpacity(e,100)),r.apply(this,arguments)},t.mouseUp=function(i){mxEvent.isPopupTrigger(i)||null!=this.currentGraph||null==this.dragElement||"none"!=this.dragElement.style.display||d.itemClicked(l,t,i,e),o.apply(t,arguments),mxUtils.setOpacity(e,100),s=null,d.currentElt=e}},Sidebar.prototype.createVertexTemplateEntry=function(e,t,l,i,n,r,o,a,s){return a=null!=a&&a.length>0?a:n.toLowerCase(),this.addEntry(a,mxUtils.bind(this,function(){return this.createVertexTemplate(e,t,l,i,n,r,o,void 0,s)}))},Sidebar.prototype.createVertexTemplate=function(e,t,l,i,n,r,o,a,s){var d;return(d=new mxCell(null!=i?i:"",new mxGeometry(0,0,t,l),e)).vertex=!0,s&&(d.data=s),this.createVertexTemplateFromCells([d],t,l,n,r,o,a)},Sidebar.prototype.createVertexTemplateFromData=function(e,t,l,i,n,r,o){var a=mxUtils.parseXml(Graph.decompress(e)),s=new mxCodec(a),d=new mxGraphModel;s.decode(a.documentElement,d);var h=this.graph.cloneCells(d.root.getChildAt(0).children);return this.createVertexTemplateFromCells(h,t,l,i,n,r,o)},Sidebar.prototype.createVertexTemplateFromCells=function(e,t,l,i,n,r,o){return this.createItem(e,i,n,r,t,l,o)},Sidebar.prototype.createEdgeTemplateEntry=function(e,t,l,i,n,r,o,a){return o=null!=o&&o.length>0?o:n.toLowerCase(),this.addEntry(o,mxUtils.bind(this,function(){return this.createEdgeTemplate(e,t,l,i,n,r,a)}))},Sidebar.prototype.createEdgeTemplate=function(e,t,l,i,n,r,o){var a=new mxCell(null!=i?i:"",new mxGeometry(0,0,t,l),e);return a.geometry.setTerminalPoint(new mxPoint(0,l),!0),a.geometry.setTerminalPoint(new mxPoint(t,0),!1),a.geometry.relative=!0,a.edge=!0,this.createEdgeTemplateFromCells([a],t,l,n,r,o)},Sidebar.prototype.createEdgeTemplateFromCells=function(e,t,l,i,n,r){return this.createItem(e,i,n,!0,t,l,r)},Sidebar.prototype.addPaletteFunctions=function(e,t,l,i){this.addPalette(e,t,l,mxUtils.bind(this,function(e){for(var t=0;t<i.length;t++)e.appendChild(i[t](e))}))},Sidebar.prototype.addPalette=function(e,t,l,i){var n;t&&(n=this.createTitle(t),this.container.appendChild(n));var r=document.createElement("div");return r.className="geSidebar",mxClient.IS_POINTER&&(r.style.touchAction="none"),l?(i(r),i=null):r.style.display="none",n&&this.addFoldingHandler(n,r,i),this.container.appendChild(r),null!=e&&(this.palettes[e]=[n,r]),r},Sidebar.prototype.addFoldingHandler=function(e,t,l){var i=!1;(!mxClient.IS_IE||document.documentMode>=8)&&(e.style.backgroundImage="none"==t.style.display?"url('"+this.collapsedImage+"')":"url('"+this.expandedImage+"')"),e.style.backgroundRepeat="no-repeat",e.style.backgroundPosition="0% 50%",mxEvent.addListener(e,"click",mxUtils.bind(this,function(n){if("none"==t.style.display){if(i)t.style.display="block";else if(i=!0,null!=l){e.style.cursor="wait";var r=e.innerHTML;e.innerHTML=mxResources.get("loading")+"...",window.setTimeout(function(){t.style.display="block",e.style.cursor="",e.innerHTML=r;var i=mxClient.NO_FO;mxClient.NO_FO=Editor.prototype.originalNoForeignObject,l(t,e),mxClient.NO_FO=i},mxClient.IS_FF?20:0)}else t.style.display="block";e.style.backgroundImage="url('"+this.expandedImage+"')"}else e.style.backgroundImage="url('"+this.collapsedImage+"')",t.style.display="none";mxEvent.consume(n)})),mxEvent.addListener(e,mxClient.IS_POINTER?"pointerdown":"mousedown",mxUtils.bind(this,function(e){e.preventDefault()}))},Sidebar.prototype.removePalette=function(e){var t=this.palettes[e];if(null!=t){this.palettes[e]=null;for(var l=0;l<t.length;l++)this.container.removeChild(t[l]);return!0}return!1},Sidebar.prototype.addImagePalette=function(e,t,l,i,n,r,o,a){for(var s=[],d=0;d<n.length;d++)mxUtils.bind(this,function(e,t,n,r){if(null==n){var o=e.lastIndexOf("/"),a=e.lastIndexOf(".");n=e.substring(o>=0?o+1:0,a>=0?a:e.length).replace(/[-_]/g," ")}s.push(this.createVertexTemplateEntry("img;html=1;labelBackgroundColor=#ffffff;image="+l+e+i,this.defaultImageWidth,this.defaultImageHeight,"",t,null!=t,null,this.filterTags(n),r))})(n[d],null!=r?r[d]:null,null!=o?o[n[d]]:null,null!=a[d]?a[d]:{});this.addPaletteFunctions(e,t,!0,s)},Sidebar.prototype.getTagsForStencil=function(e,t,l){for(var i=e.split("."),n=1;n<i.length;n++)i[n]=i[n].replace(/_/g," ");return i.push(t.replace(/_/g," ")),null!=l&&i.push(l),i.slice(1,i.length)},Sidebar.prototype.destroy=function(){null!=this.graph&&(null!=this.graph.container&&null!=this.graph.container.parentNode&&this.graph.container.parentNode.removeChild(this.graph.container),this.graph.destroy(),this.graph=null),null!=this.pointerUpHandler&&(mxEvent.removeListener(document,mxClient.IS_POINTER?"pointerup":"mouseup",this.pointerUpHandler),this.pointerUpHandler=null),null!=this.pointerDownHandler&&(mxEvent.removeListener(document,mxClient.IS_POINTER?"pointerdown":"mousedown",this.pointerDownHandler),this.pointerDownHandler=null),null!=this.pointerMoveHandler&&(mxEvent.removeListener(document,mxClient.IS_POINTER?"pointermove":"mousemove",this.pointerMoveHandler),this.pointerMoveHandler=null),null!=this.pointerOutHandler&&(mxEvent.removeListener(document,mxClient.IS_POINTER?"pointerout":"mouseout",this.pointerOutHandler),this.pointerOutHandler=null)};