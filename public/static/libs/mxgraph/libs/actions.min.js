function Actions(e){this.editorUi=e,this.actions=new Object,this.init()}function Action(e,t,n,l,i){mxEventSource.call(this),this.label=e,this.funct=this.createFunction(t),this.enabled=null==n||n,this.iconCls=l,this.shortcut=i,this.visible=!0}Actions.prototype.init=function(){var e=this.editorUi,t=e.editor,n=t.graph,l=function(){return Action.prototype.isEnabled.apply(this,arguments)&&n.isEnabled()};function i(e){n.escape();var t=n.getDeletableCells(n.getSelectionCells());if(null!=t&&t.length>0){var l=n.selectParentAfterDelete?n.model.getParents(t):null;if(n.removeCells(t,e),null!=l){for(var i=[],o=0;o<l.length;o++)n.model.contains(l[o])&&(n.model.isVertex(l[o])||n.model.isEdge(l[o]))&&i.push(l[o]);n.setSelectionCells(i)}}}this.addAction("new...",function(){n.openLink(e.getUrl())}),this.addAction("open...",function(){window.openNew=!0,window.openKey="open",e.openFile()}),this.addAction("import...",function(){window.openNew=!1,window.openKey="import",window.openFile=new OpenFile(mxUtils.bind(this,function(){e.hideDialog()})),window.openFile.setConsumer(mxUtils.bind(this,function(e,n){try{var l=mxUtils.parseXml(e);t.graph.setSelectionCells(t.graph.importGraphModel(l.documentElement))}catch(e){mxUtils.alert(mxResources.get("invalidOrMissingFile")+": "+e.message)}})),e.showDialog(new OpenDialog(this).container,320,220,!0,!0,function(){window.openFile=null})}).isEnabled=l,this.addAction("save",function(){e.saveFile(!1)},null,null,Editor.ctrlKey+"+S").isEnabled=l,this.addAction("saveData",function(e){n.saveData()},null,null,Editor.ctrlKey+"+S").isEnabled=l,this.addAction("saveAs...",function(){e.saveFile(!0)},null,null,Editor.ctrlKey+"+Shift+S").isEnabled=l,this.addAction("export...",function(){e.showDialog(new ExportDialog(e).container,300,296,!0,!0)}),this.addAction("editDiagram",function(){var t=new EditDiagramDialog(e);e.showDialog(t.container,620,420,!0,!1),t.init()}),this.addAction("pageSetup...",function(){e.showDialog(new PageSetupDialog(e).container,320,220,!0,!0)}).isEnabled=l,this.addAction("print...",function(){e.showDialog(new PrintDialog(e).container,300,180,!0,!0)},null,"sprite-print",Editor.ctrlKey+"+P"),this.addAction("preview",function(){mxUtils.show(n,null,10,10)}),this.addAction("undo",function(){e.undo()},null,"sprite-undo",Editor.ctrlKey+"+Z"),this.addAction("redo",function(){e.redo()},null,"sprite-redo",mxClient.IS_WIN?Editor.ctrlKey+"+Y":Editor.ctrlKey+"+Shift+Z"),this.addAction("cut",function(){mxClipboard.cut(n)},null,"sprite-cut",Editor.ctrlKey+"+X"),this.addAction("copy",function(){mxClipboard.copy(n)},null,"sprite-copy",Editor.ctrlKey+"+C"),this.addAction("paste",function(){n.isEnabled()&&!n.isCellLocked(n.getDefaultParent())&&mxClipboard.paste(n)},!1,"sprite-paste",Editor.ctrlKey+"+V"),this.addAction("pasteHere",function(e){if(n.isEnabled()&&!n.isCellLocked(n.getDefaultParent())){n.getModel().beginUpdate();try{var t=mxClipboard.paste(n);if(null!=t){for(var l=!0,i=0;i<t.length&&l;i++)l=l&&n.model.isEdge(t[i]);var o=n.view.translate,s=n.view.scale,a=o.x,c=o.y,d=null;if(1==t.length&&l){var r=n.getCellGeometry(t[0]);null!=r&&(d=r.getTerminalPoint(!0))}if(null!=(d=null!=d?d:n.getBoundingBoxFromGeometry(t,l))){var u=Math.round(n.snap(n.popupMenuHandler.triggerX/s-a)),g=Math.round(n.snap(n.popupMenuHandler.triggerY/s-c));n.cellsMoved(t,u-d.x,g-d.y)}}}finally{n.getModel().endUpdate()}}}),this.addAction("copySize",function(t){var l=n.getSelectionCell();if(n.isEnabled()&&null!=l&&n.getModel().isVertex(l)){var i=n.getCellGeometry(l);null!=i&&(e.copiedSize=new mxRectangle(i.x,i.y,i.width,i.height))}},null,null,"Alt+Shit+X"),this.addAction("pasteSize",function(t){if(n.isEnabled()&&!n.isSelectionEmpty()&&null!=e.copiedSize){n.getModel().beginUpdate();try{for(var l=n.getSelectionCells(),i=0;i<l.length;i++)if(n.getModel().isVertex(l[i])){var o=n.getCellGeometry(l[i]);null!=o&&((o=o.clone()).width=e.copiedSize.width,o.height=e.copiedSize.height,n.getModel().setGeometry(l[i],o))}}finally{n.getModel().endUpdate()}}},null,null,"Alt+Shit+V"),this.addAction("delete",function(e){i(null!=e&&mxEvent.isShiftDown(e))},null,null,"Delete"),this.addAction("deleteAll",function(){i(!0)},null,null,Editor.ctrlKey+"+Delete"),this.addAction("duplicate",function(){n.setSelectionCells(n.duplicateCells())},null,null,Editor.ctrlKey+"+D"),this.put("turn",new Action(mxResources.get("turn")+" / "+mxResources.get("reverse"),function(){n.turnShapes(n.getSelectionCells())},null,null,Editor.ctrlKey+"+R")),this.addAction("selectVertices",function(){n.selectVertices()},null,null,Editor.ctrlKey+"+Shift+I"),this.addAction("selectEdges",function(){n.selectEdges()},null,null,Editor.ctrlKey+"+Shift+E"),this.addAction("selectAll",function(){n.selectAll(null,!0)},null,null,Editor.ctrlKey+"+A"),this.addAction("selectNone",function(){n.clearSelection()},null,null,Editor.ctrlKey+"+Shift+A"),this.addAction("lockUnlock",function(){if(!n.isSelectionEmpty()){n.getModel().beginUpdate();try{var e=n.isCellMovable(n.getSelectionCell())?1:0;n.toggleCellStyles(mxConstants.STYLE_MOVABLE,e),n.toggleCellStyles(mxConstants.STYLE_RESIZABLE,e),n.toggleCellStyles(mxConstants.STYLE_ROTATABLE,e),n.toggleCellStyles(mxConstants.STYLE_DELETABLE,e),n.toggleCellStyles(mxConstants.STYLE_EDITABLE,e),n.toggleCellStyles("connectable",e)}finally{n.getModel().endUpdate()}}},null,null,Editor.ctrlKey+"+L"),this.addAction("home",function(){n.home()},null,null,"Home"),this.addAction("exitGroup",function(){n.exitGroup()},null,null,Editor.ctrlKey+"+Shift+Home"),this.addAction("enterGroup",function(){n.enterGroup()},null,null,Editor.ctrlKey+"+Shift+End"),this.addAction("collapse",function(){n.foldCells(!0)},null,null,Editor.ctrlKey+"+Home"),this.addAction("expand",function(){n.foldCells(!1)},null,null,Editor.ctrlKey+"+End"),this.addAction("toFront",function(){n.orderCells(!1)},null,null,Editor.ctrlKey+"+Shift+F"),this.addAction("toBack",function(){n.orderCells(!0)},null,null,Editor.ctrlKey+"+Shift+B"),this.addAction("group",function(){1==n.getSelectionCount()?n.setCellStyles("container","1"):n.setSelectionCell(n.groupCells(null,0))},null,null,Editor.ctrlKey+"+G"),this.addAction("ungroup",function(){1==n.getSelectionCount()&&0==n.getModel().getChildCount(n.getSelectionCell())?n.setCellStyles("container","0"):n.setSelectionCells(n.ungroupCells())},null,null,Editor.ctrlKey+"+Shift+U"),this.addAction("removeFromGroup",function(){n.removeCellsFromParent()}),this.addAction("edit",function(){n.isEnabled()&&n.startEditingAtCell()},null,null,"F2/Enter"),this.addAction("editData...",function(){var t=n.getSelectionCell()||n.getModel().getRoot();e.showDataDialog(t)},null,null,Editor.ctrlKey+"+M"),this.addAction("editTooltip...",function(){var t=e.editor.graph;if(t.isEnabled()&&!t.isSelectionEmpty()){var n=t.getSelectionCell(),l="";if(mxUtils.isNode(n.value)){var i=n.value.getAttribute("tooltip");null!=i&&(l=i)}var o=new TextareaDialog(e,mxResources.get("editTooltip")+":",l,function(e){t.setTooltipForCell(n,e)});e.showDialog(o.container,320,200,!0,!0),o.init()}},null,null,"Alt+Shift+T"),this.addAction("openLink",function(){var e=n.getLinkForCell(n.getSelectionCell());null!=e&&n.openLink(e)}),this.addAction("editLink...",function(){var t=e.editor.graph;if(t.isEnabled()&&!t.isSelectionEmpty()){var n=t.getSelectionCell(),l=t.getLinkForCell(n)||"";e.showLinkDialog(l,mxResources.get("apply"),function(e){e=mxUtils.trim(e),t.setLinkForCell(n,e.length>0?e:null)})}},null,null,"Alt+Shift+L"),this.put("insertImage",new Action(mxResources.get("image")+"...",function(){n.isEnabled()&&!n.isCellLocked(n.getDefaultParent())&&(n.clearSelection(),e.actions.get("image").funct())})).isEnabled=l,this.put("insertLink",new Action(mxResources.get("link")+"...",function(){n.isEnabled()&&!n.isCellLocked(n.getDefaultParent())&&e.showLinkDialog("",mxResources.get("insert"),function(e,t){if((e=mxUtils.trim(e)).length>0){var l=null,i=n.getLinkTitle(e);null!=t&&t.length>0&&(l=t[0].iconUrl,(i=(i=t[0].name||t[0].type).charAt(0).toUpperCase()+i.substring(1)).length>30&&(i=i.substring(0,30)+"..."));var o=n.getFreeInsertPoint(),s=new mxCell(i,new mxGeometry(o.x,o.y,100,40),"fontColor=#0000EE;fontStyle=4;rounded=1;overflow=hidden;"+(null!=l?"shape=label;imageWidth=16;imageHeight=16;spacingLeft=26;align=left;image="+l:"spacing=10;"));s.vertex=!0,n.setLinkForCell(s,e),n.cellSizeUpdated(s,!0),n.getModel().beginUpdate();try{s=n.addCell(s),n.fireEvent(new mxEventObject("cellsInserted","cells",[s]))}finally{n.getModel().endUpdate()}n.setSelectionCell(s),n.scrollCellToVisible(n.getSelectionCell())}})})).isEnabled=l,this.addAction("link...",mxUtils.bind(this,function(){var t=e.editor.graph;if(t.isEnabled())if(t.cellEditor.isContentEditing()){var n=t.getSelectedElement(),l=t.getParentByName(n,"A",t.cellEditor.textarea),i="";if(null==l&&null!=n&&null!=n.getElementsByTagName)for(var o=n.getElementsByTagName("a"),s=0;s<o.length&&null==l;s++)o[s].textContent==n.textContent&&(l=o[s]);null!=l&&"A"==l.nodeName&&(i=l.getAttribute("href")||"",t.selectNode(l));var a=t.cellEditor.saveSelection();e.showLinkDialog(i,mxResources.get("apply"),mxUtils.bind(this,function(e){t.cellEditor.restoreSelection(a),null!=e&&t.insertLink(e)}))}else t.isSelectionEmpty()?this.get("insertLink").funct():this.get("editLink").funct()})).isEnabled=l,this.addAction("autosize",function(){var e=n.getSelectionCells();if(null!=e){n.getModel().beginUpdate();try{for(var t=0;t<e.length;t++){var l=e[t];if(n.getModel().getChildCount(l))n.updateGroupBounds([l],20);else{var i=n.view.getState(l),o=n.getCellGeometry(l);n.getModel().isVertex(l)&&null!=i&&null!=i.text&&null!=o&&n.isWrapping(l)?((o=o.clone()).height=i.text.boundingBox.height/n.view.scale,n.getModel().setGeometry(l,o)):n.updateCellSize(l)}}}finally{n.getModel().endUpdate()}}},null,null,Editor.ctrlKey+"+Shift+Y"),this.addAction("formattedText",function(){var t=n.getView().getState(n.getSelectionCell());if(null!=t){var l="1";n.stopEditing(),n.getModel().beginUpdate();try{if("1"==t.style.html){l=null;var i=n.convertValueToString(t.cell);"0"!=mxUtils.getValue(t.style,"nl2Br","1")&&(i=i.replace(/\n/g,"").replace(/<br\s*.?>/g,"\n"));var o=document.createElement("div");o.innerHTML=i,i=mxUtils.extractTextWithWhitespace(o.childNodes),n.cellLabelChanged(t.cell,i)}else{i=mxUtils.htmlEntities(n.convertValueToString(t.cell),!1);"0"!=mxUtils.getValue(t.style,"nl2Br","1")&&(i=i.replace(/\n/g,"<br/>")),n.cellLabelChanged(t.cell,n.sanitizeHtml(i))}n.setCellStyles("html",l),e.fireEvent(new mxEventObject("styleChanged","keys",["html"],"values",[null!=l?l:"0"],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}}}),this.addAction("wordWrap",function(){var e=n.getView().getState(n.getSelectionCell()),t="wrap";n.stopEditing(),null!=e&&"wrap"==e.style[mxConstants.STYLE_WHITE_SPACE]&&(t=null),n.setCellStyles(mxConstants.STYLE_WHITE_SPACE,t)}),this.addAction("rotation",function(){var t="0",l=n.getView().getState(n.getSelectionCell());null!=l&&(t=l.style[mxConstants.STYLE_ROTATION]||t);var i=new FilenameDialog(e,t,mxResources.get("apply"),function(e){null!=e&&e.length>0&&n.setCellStyles(mxConstants.STYLE_ROTATION,e)},mxResources.get("enterValue")+" ("+mxResources.get("rotation")+" 0-360)");e.showDialog(i.container,375,80,!0,!0),i.init()}),this.addAction("resetView",function(){n.zoomTo(1),e.resetScrollbars()},null,null,Editor.ctrlKey+"+H"),this.addAction("zoomIn",function(e){n.zoomIn()},null,null,Editor.ctrlKey+" + (Numpad) / Alt+Mousewheel"),this.addAction("zoomOut",function(e){n.zoomOut()},null,null,Editor.ctrlKey+" - (Numpad) / Alt+Mousewheel"),this.addAction("fitWindow",function(){var e=n.isSelectionEmpty()?n.getGraphBounds():n.getBoundingBox(n.getSelectionCells()),t=n.view.translate,l=n.view.scale;e.width/=l,e.height/=l,e.x=e.x/l-t.x,e.y=e.y/l-t.y;var i=n.container.clientWidth-10,o=n.container.clientHeight-10,s=Math.floor(20*Math.min(i/e.width,o/e.height))/20;n.zoomTo(s),mxUtils.hasScrollbars(n.container)&&(n.container.scrollTop=(e.y+t.y)*s-Math.max((o-e.height*s)/2+5,0),n.container.scrollLeft=(e.x+t.x)*s-Math.max((i-e.width*s)/2+5,0))},null,null,Editor.ctrlKey+"+Shift+H"),this.addAction("fitPage",mxUtils.bind(this,function(){n.pageVisible||this.get("pageView").funct();var e=n.pageFormat,t=n.pageScale,l=n.container.clientWidth-10,i=n.container.clientHeight-10,o=Math.floor(20*Math.min(l/e.width/t,i/e.height/t))/20;if(n.zoomTo(o),mxUtils.hasScrollbars(n.container)){var s=n.getPagePadding();n.container.scrollTop=s.y*n.view.scale-1,n.container.scrollLeft=Math.min(s.x*n.view.scale,(n.container.scrollWidth-n.container.clientWidth)/2)-1}}),null,null,Editor.ctrlKey+"+J"),this.addAction("fitTwoPages",mxUtils.bind(this,function(){n.pageVisible||this.get("pageView").funct();var e=n.pageFormat,t=n.pageScale,l=n.container.clientWidth-10,i=n.container.clientHeight-10,o=Math.floor(20*Math.min(l/(2*e.width)/t,i/e.height/t))/20;if(n.zoomTo(o),mxUtils.hasScrollbars(n.container)){var s=n.getPagePadding();n.container.scrollTop=Math.min(s.y,(n.container.scrollHeight-n.container.clientHeight)/2),n.container.scrollLeft=Math.min(s.x,(n.container.scrollWidth-n.container.clientWidth)/2)}}),null,null,Editor.ctrlKey+"+Shift+J"),this.addAction("fitPageWidth",mxUtils.bind(this,function(){n.pageVisible||this.get("pageView").funct();var e=n.pageFormat,t=n.pageScale,l=n.container.clientWidth-10,i=Math.floor(20*l/e.width/t)/20;if(n.zoomTo(i),mxUtils.hasScrollbars(n.container)){var o=n.getPagePadding();n.container.scrollLeft=Math.min(o.x*n.view.scale,(n.container.scrollWidth-n.container.clientWidth)/2)}})),this.put("customZoom",new Action(mxResources.get("custom")+"...",mxUtils.bind(this,function(){var e=new FilenameDialog(this.editorUi,parseInt(100*n.getView().getScale()),mxResources.get("apply"),mxUtils.bind(this,function(e){var t=parseInt(e);!isNaN(t)&&t>0&&n.zoomTo(t/100)}),mxResources.get("zoom")+" (%)");this.editorUi.showDialog(e.container,300,80,!0,!0),e.init()}),null,null,Editor.ctrlKey+"+0")),this.addAction("pageScale...",mxUtils.bind(this,function(){var t=new FilenameDialog(this.editorUi,parseInt(100*n.pageScale),mxResources.get("apply"),mxUtils.bind(this,function(t){var n=parseInt(t);!isNaN(n)&&n>0&&e.setPageScale(n/100)}),mxResources.get("pageScale")+" (%)");this.editorUi.showDialog(t.container,300,80,!0,!0),t.init()}));var o=null;(o=this.addAction("grid",function(){n.setGridEnabled(!n.isGridEnabled()),e.fireEvent(new mxEventObject("gridEnabledChanged"))},null,null,Editor.ctrlKey+"+Shift+G")).setToggleAction(!0),o.setSelectedCallback(function(){return n.isGridEnabled()}),o.setEnabled(!1),(o=this.addAction("guides",function(){n.graphHandler.guidesEnabled=!n.graphHandler.guidesEnabled,e.fireEvent(new mxEventObject("guidesEnabledChanged"))})).setToggleAction(!0),o.setSelectedCallback(function(){return n.graphHandler.guidesEnabled}),o.setEnabled(!1),(o=this.addAction("tooltips",function(){n.tooltipHandler.setEnabled(!n.tooltipHandler.isEnabled())})).setToggleAction(!0),o.setSelectedCallback(function(){return n.tooltipHandler.isEnabled()}),(o=this.addAction("collapseExpand",function(){var t=new ChangePageSetup(e);t.ignoreColor=!0,t.ignoreImage=!0,t.foldingEnabled=!n.foldingEnabled,n.model.execute(t)})).setToggleAction(!0),o.setSelectedCallback(function(){return n.foldingEnabled}),o.isEnabled=l,(o=this.addAction("scrollbars",function(){e.setScrollbars(!e.hasScrollbars())})).setToggleAction(!0),o.setSelectedCallback(function(){return n.scrollbars}),(o=this.addAction("pageView",mxUtils.bind(this,function(){e.setPageVisible(!n.pageVisible)}))).setToggleAction(!0),o.setSelectedCallback(function(){return n.pageVisible}),(o=this.addAction("connectionArrows",function(){n.connectionArrowsEnabled=!n.connectionArrowsEnabled,e.fireEvent(new mxEventObject("connectionArrowsChanged"))},null,null,"Alt+Shift+A")).setToggleAction(!0),o.setSelectedCallback(function(){return n.connectionArrowsEnabled}),(o=this.addAction("connectionPoints",function(){n.setConnectable(!n.connectionHandler.isEnabled()),e.fireEvent(new mxEventObject("connectionPointsChanged"))},null,null,"Alt+Shift+P")).setToggleAction(!0),o.setSelectedCallback(function(){return n.connectionHandler.isEnabled()}),(o=this.addAction("copyConnect",function(){n.connectionHandler.setCreateTarget(!n.connectionHandler.isCreateTarget()),e.fireEvent(new mxEventObject("copyConnectChanged"))})).setToggleAction(!0),o.setSelectedCallback(function(){return n.connectionHandler.isCreateTarget()}),o.isEnabled=l,(o=this.addAction("autosave",function(){e.editor.setAutosave(!e.editor.autosave)})).setToggleAction(!0),o.setSelectedCallback(function(){return e.editor.autosave}),o.isEnabled=l,o.visible=!1,this.addAction("help",function(){var e="";mxResources.isLanguageSupported(mxClient.language)&&(e="_"+mxClient.language),n.openLink(RESOURCES_PATH+"help"+e+".html")}),this.addAction("relayout",function(){n.relayout()});var s=!1;this.put("about",new Action(mxResources.get("about")+" Graph Editor...",function(){s||(e.showDialog(new AboutDialog(e).container,320,280,!0,!0,function(){s=!1}),s=!0)},null,null,"F1"));var a=mxUtils.bind(this,function(e,t,l,i){return this.addAction(e,function(){if(null!=l&&n.cellEditor.isContentEditing())l();else{n.stopEditing(!1),n.getModel().beginUpdate();try{n.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,t),(t&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD?n.updateLabelElements(n.getSelectionCells(),function(e){e.style.fontWeight=null,"B"==e.nodeName&&n.replaceElement(e)}):(t&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC?n.updateLabelElements(n.getSelectionCells(),function(e){e.style.fontStyle=null,"I"==e.nodeName&&n.replaceElement(e)}):(t&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&n.updateLabelElements(n.getSelectionCells(),function(e){e.style.textDecoration=null,"U"==e.nodeName&&n.replaceElement(e)})}finally{n.getModel().endUpdate()}}},null,null,i)});a("bold",mxConstants.FONT_BOLD,function(){document.execCommand("bold",!1,null)},Editor.ctrlKey+"+B"),a("italic",mxConstants.FONT_ITALIC,function(){document.execCommand("italic",!1,null)},Editor.ctrlKey+"+I"),a("underline",mxConstants.FONT_UNDERLINE,function(){document.execCommand("underline",!1,null)},Editor.ctrlKey+"+U"),this.addAction("fontColor...",function(){e.menus.pickColor(mxConstants.STYLE_FONTCOLOR,"forecolor","000000")}),this.addAction("strokeColor...",function(){e.menus.pickColor(mxConstants.STYLE_STROKECOLOR)}),this.addAction("fillColor...",function(){e.menus.pickColor(mxConstants.STYLE_FILLCOLOR)}),this.addAction("gradientColor...",function(){e.menus.pickColor(mxConstants.STYLE_GRADIENTCOLOR)}),this.addAction("backgroundColor...",function(){e.menus.pickColor(mxConstants.STYLE_LABEL_BACKGROUNDCOLOR,"backcolor")}),this.addAction("borderColor...",function(){e.menus.pickColor(mxConstants.STYLE_LABEL_BORDERCOLOR)}),this.addAction("vertical",function(){e.menus.toggleStyle(mxConstants.STYLE_HORIZONTAL,!0)}),this.addAction("shadow",function(){e.menus.toggleStyle(mxConstants.STYLE_SHADOW)}),this.addAction("solid",function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_DASHED,null),n.setCellStyles(mxConstants.STYLE_DASH_PATTERN,null),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",[null,null],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}}),this.addAction("dashed",function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_DASHED,"1"),n.setCellStyles(mxConstants.STYLE_DASH_PATTERN,null),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",["1",null],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}}),this.addAction("dotted",function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_DASHED,"1"),n.setCellStyles(mxConstants.STYLE_DASH_PATTERN,"1 4"),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",["1","1 4"],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}}),this.addAction("sharp",function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_ROUNDED,"0"),n.setCellStyles(mxConstants.STYLE_CURVED,"0"),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["0","0"],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}}),this.addAction("rounded",function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_ROUNDED,"1"),n.setCellStyles(mxConstants.STYLE_CURVED,"0"),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["1","0"],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}}),this.addAction("toggleRounded",function(){if(!n.isSelectionEmpty()&&n.isEnabled()){n.getModel().beginUpdate();try{var t=n.getSelectionCells(),l=n.view.getState(t[0]),i=null!=l?l.style:n.getCellStyle(t[0]),o="1"==mxUtils.getValue(i,mxConstants.STYLE_ROUNDED,"0")?"0":"1";n.setCellStyles(mxConstants.STYLE_ROUNDED,o),n.setCellStyles(mxConstants.STYLE_CURVED,null),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",[o,"0"],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}}}),this.addAction("curved",function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_ROUNDED,"0"),n.setCellStyles(mxConstants.STYLE_CURVED,"1"),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["0","1"],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}}),this.addAction("collapsible",function(){var t=n.view.getState(n.getSelectionCell()),l="1";null!=t&&null!=n.getFoldingImage(t)&&(l="0"),n.setCellStyles("collapsible",l),e.fireEvent(new mxEventObject("styleChanged","keys",["collapsible"],"values",[l],"cells",n.getSelectionCells()))}),this.addAction("editStyle...",mxUtils.bind(this,function(){var e=n.getSelectionCells();if(null!=e&&e.length>0){var t=n.getModel(),l=new TextareaDialog(this.editorUi,mxResources.get("editStyle")+":",t.getStyle(e[0])||"",function(t){null!=t&&n.setCellStyle(mxUtils.trim(t),e)},null,null,400,220);this.editorUi.showDialog(l.container,420,300,!0,!0),l.init()}}),null,null,Editor.ctrlKey+"+E"),this.addAction("setAsDefaultStyle",function(){n.isEnabled()&&!n.isSelectionEmpty()&&e.setDefaultStyle(n.getSelectionCell())},null,null,Editor.ctrlKey+"+Shift+D"),this.addAction("clearDefaultStyle",function(){n.isEnabled()&&e.clearDefaultStyle()},null,null,Editor.ctrlKey+"+Shift+R"),this.addAction("addWaypoint",function(){var e=n.getSelectionCell();if(null!=e&&n.getModel().isEdge(e)){var l=t.graph.selectionCellsHandler.getHandler(e);if(l instanceof mxEdgeHandler){for(var i=n.view.translate,o=n.view.scale,s=i.x,a=i.y,c=n.getModel().getParent(e),d=n.getCellGeometry(c);n.getModel().isVertex(c)&&null!=d;)s+=d.x,a+=d.y,c=n.getModel().getParent(c),d=n.getCellGeometry(c);var r=Math.round(n.snap(n.popupMenuHandler.triggerX/o-s)),u=Math.round(n.snap(n.popupMenuHandler.triggerY/o-a));l.addPointAt(l.state,r,u)}}}),this.addAction("removeWaypoint",function(){var t=e.actions.get("removeWaypoint");null!=t.handler&&t.handler.removePoint(t.handler.state,t.index)}),this.addAction("clearWaypoints",function(){var e=n.getSelectionCells();if(null!=e){e=n.addAllEdges(e),n.getModel().beginUpdate();try{for(var t=0;t<e.length;t++){var l=e[t];if(n.getModel().isEdge(l)){var i=n.getCellGeometry(l);null!=i&&((i=i.clone()).points=null,n.getModel().setGeometry(l,i))}}}finally{n.getModel().endUpdate()}}},null,null,"Alt+Shift+C"),o=this.addAction("subscript",mxUtils.bind(this,function(){n.cellEditor.isContentEditing()&&document.execCommand("subscript",!1,null)}),null,null,Editor.ctrlKey+"+,"),o=this.addAction("superscript",mxUtils.bind(this,function(){n.cellEditor.isContentEditing()&&document.execCommand("superscript",!1,null)}),null,null,Editor.ctrlKey+"+."),this.addAction("image...",function(){if(n.isEnabled()&&!n.isCellLocked(n.getDefaultParent())){var t=mxResources.get("image")+" ("+mxResources.get("url")+"):",l=n.getView().getState(n.getSelectionCell()),i="";null!=l&&(i=l.style[mxConstants.STYLE_IMAGE]||i);var o=n.cellEditor.saveSelection();e.showImageDialog(t,i,function(e,t,l){if(n.cellEditor.isContentEditing())n.cellEditor.restoreSelection(o),n.insertImage(e,t,l);else{var i=n.getSelectionCells();if(null!=e&&(e.length>0||i.length>0)){var s=null;n.getModel().beginUpdate();try{if(0==i.length){var a=n.getFreeInsertPoint();s=i=[n.insertVertex(n.getDefaultParent(),null,"",a.x,a.y,t,l,"shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;")],n.fireEvent(new mxEventObject("cellsInserted","cells",s))}n.setCellStyles(mxConstants.STYLE_IMAGE,e.length>0?e:null,i);var c=n.view.getState(i[0]),d=null!=c?c.style:n.getCellStyle(i[0]);if("image"!=d[mxConstants.STYLE_SHAPE]&&"label"!=d[mxConstants.STYLE_SHAPE]?n.setCellStyles(mxConstants.STYLE_SHAPE,"image",i):0==e.length&&n.setCellStyles(mxConstants.STYLE_SHAPE,null,i),1==n.getSelectionCount()&&null!=t&&null!=l){var r=i[0],u=n.getModel().getGeometry(r);null!=u&&((u=u.clone()).width=t,u.height=l,n.getModel().setGeometry(r,u))}}finally{n.getModel().endUpdate()}null!=s&&(n.setSelectionCells(s),n.scrollCellToVisible(s[0]))}}},n.cellEditor.isContentEditing(),!n.cellEditor.isContentEditing())}}).isEnabled=l,(o=this.addAction("layers",mxUtils.bind(this,function(){null==this.layersWindow?(this.layersWindow=new LayersWindow(e,document.body.offsetWidth-280,120,220,180),this.layersWindow.window.addListener("show",function(){e.fireEvent(new mxEventObject("layers"))}),this.layersWindow.window.addListener("hide",function(){e.fireEvent(new mxEventObject("layers"))}),this.layersWindow.window.setVisible(!0),e.fireEvent(new mxEventObject("layers"))):this.layersWindow.window.setVisible(!this.layersWindow.window.isVisible())}),null,null,Editor.ctrlKey+"+Shift+L")).setToggleAction(!0),o.setSelectedCallback(mxUtils.bind(this,function(){return null!=this.layersWindow&&this.layersWindow.window.isVisible()})),(o=this.addAction("formatPanel",mxUtils.bind(this,function(){e.toggleFormatPanel()}),null,null,Editor.ctrlKey+"+Shift+P")).setToggleAction(!0),o.setSelectedCallback(mxUtils.bind(this,function(){return e.formatWidth>0})),(o=this.addAction("outline",mxUtils.bind(this,function(){null==this.outlineWindow?(this.outlineWindow=new OutlineWindow(e,document.body.offsetWidth-260,100,180,180),this.outlineWindow.window.addListener("show",function(){e.fireEvent(new mxEventObject("outline"))}),this.outlineWindow.window.addListener("hide",function(){e.fireEvent(new mxEventObject("outline"))}),this.outlineWindow.window.setVisible(!0),e.fireEvent(new mxEventObject("outline"))):this.outlineWindow.window.setVisible(!this.outlineWindow.window.isVisible())}),null,null,Editor.ctrlKey+"+Shift+O")).setToggleAction(!0),o.setSelectedCallback(mxUtils.bind(this,function(){return null!=this.outlineWindow&&this.outlineWindow.window.isVisible()}))},Actions.prototype.addAction=function(e,t,n,l,i){var o;return"..."==e.substring(e.length-3)?(e=e.substring(0,e.length-3),o=mxResources.get(e)+"..."):o=mxResources.get(e),this.put(e,new Action(o,t,n,l,i))},Actions.prototype.put=function(e,t){return this.actions[e]=t,t},Actions.prototype.get=function(e){return this.actions[e]},mxUtils.extend(Action,mxEventSource),Action.prototype.createFunction=function(e){return e},Action.prototype.setEnabled=function(e){this.enabled!=e&&(this.enabled=e,this.fireEvent(new mxEventObject("stateChanged")))},Action.prototype.isEnabled=function(){return this.enabled},Action.prototype.setToggleAction=function(e){this.toggleAction=e},Action.prototype.setSelectedCallback=function(e){this.selectedCallback=e},Action.prototype.isSelected=function(){return this.selectedCallback()};